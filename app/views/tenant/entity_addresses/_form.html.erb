<!-- app/views/tenant/entity_addresses/_form.html.erb -->
<%= form_with model: [:tenant, @entity, @address], 
              url: @address.new_record? ? entity_address_path(@entity) : entity_address_path(@entity),
              local: true, 
              class: "space-y-4" do |f| %>
  
  <% if @address.errors.any? %>
    <div class="alert alert-danger">
      <h3><%= pluralize(@address.errors.count, "error") %> impidieron guardar:</h3>
      <ul>
        <% @address.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%# Campo oculto para address_type (siempre 'work') %>
  <%= f.hidden_field :address_type_id, value: @address.address_type&.id %>

  <div class="alert alert-info">
    <strong>Tipo de dirección:</strong> Dirección de Trabajo
  </div>

  <div class="form-group">
    <%= f.label :street, "Calle", class: "form-label" %>
    <%= f.text_field :street, class: "form-control", placeholder: "Ej: Calle Mayor, 123" %>
  </div>

  <div class="row">
    <div class="col-md-6">
      <%= f.label :postal_code, "Código Postal", class: "form-label" %>
      <%= f.text_field :postal_code, class: "form-control", placeholder: "28001" %>
    </div>
    <div class="col-md-6">
      <%= f.label :city, "Ciudad", class: "form-label" %>
      <%= f.text_field :city, class: "form-control", placeholder: "Madrid" %>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :province, "Provincia", class: "form-label" %>
    <%= f.text_field :province, class: "form-control", placeholder: "Madrid" %>
  </div>

  <div class="form-group">
    <%= f.label :country_id, "País", class: "form-label" %>
    <%= f.collection_select :country_id, 
          MasterData::Country.all, 
          :id, :name, 
          { prompt: "Selecciona un país" }, 
          class: "form-select" %>
  </div>

  <div class="d-flex gap-2">
    <%= f.submit @address.new_record? ? "Crear Dirección" : "Actualizar Dirección", 
                 class: "btn btn-primary" %>
    <%= link_to "Cancelar", company_configuration_path, class: "btn btn-secondary" %>
  </div>
<% end %>